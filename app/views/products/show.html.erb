
<%= render "/shared/header" %>
<%= render "/shared/clickable-avatar" %>

<div class="products-container">
  <div class="card">
  <% if @product.picture.attached? %>
    <%= cl_image_tag(@product.picture.key, width: 370, height: 300, crop: :fill) %>
  <% end %>
  <div class="card-body">
    <h2 class="card-title"><%= @product.name %></h2>
    <p class="card-text"><%= @product.description %></p>
  </div>
  <ul class="list-group list-group-flush">
    <li class="list-group-item"><i class="fab fa-envira"></i> Environment: <%= @product.environment %>/100</li>
    <li class="list-group-item"><i class="fas fa-people-carry"></i> Labor: <%= @product.labor %>/100</li>
    <li class="list-group-item"><i class="fas fa-paw"></i> Animal: <%= @product.animal %>/100</li>
    <li class="list-group-item"><i class="fas fa-recycle"></i> Composition: <%= @product.composition %>/100</li>
  </ul>
  <div class="card-body">
    <a href="/" class="card-link">Buy on Website</a>
  </div>
  <div data-controller="insert-in-list">
    <div data-insert-in-list-target="items">
      <h2 id="feedbacks-list">The reviews</h2>
      <a href="#leave-feedback"> Write a review
        <i class="fas fa-plus-circle"></i>
      </a>
      <div class="feedback-container">
        <% @product.feedbacks.order(created_at: :desc).each do |feedback|%>
          <%=render "feedbacks/feedback", feedback: feedback %>
        <% end %>
        </div>
    </div>

  </div>
  <div class="form-feedback" id="leave-feedback">
    <h2>Leave a review</h2>
    <%= simple_form_for([@product, @feedback], remote: true) do |f| %>
      <%= f.label :purchase_date, 'Purchase date' %>
      <%= f.text_field :purchase_date, as: :date, html5: true, required: true %>
      <%= f.input :comment, placeholder: "Tell us what you like/dislike about the product" %>
      <%= f.label :picture_worn, "Upload a picture of your product" %>
      <%= f.input_field :picture_worn, as: :file %>
      <%= f.submit "Submit review", class:"btn-light-green" %>
    <% end %>
  </div>
</div>
